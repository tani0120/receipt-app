---
description: Screen E開発および全機能開発における「正の世界」と「鏡の世界」の厳格な分離ルール
---

# 【重要・絶対遵守】エージェント行動規範 (Code of Conduct)

このドキュメントは、AIエージェントが開発を行う際に**必ず遵守しなければならない最重要ルール**である。
過去の失敗を教訓とし、以下のプロトコルを厳守すること。

## 0. 言語・コミュニケーション規定 (Language Protocol)

### 🔴 完全日本語対応 (Japanese Only)
- **原則**: すべての出力（思考プロセス、ツール呼び出しの引数内の説明、ユーザーへの回答、ドキュメント）において、**日本語を使用しなければならない**。
- **禁止事項**: ユーザーへのメッセージを英語で出力することは、重大な違反行為とみなす。
- **例外**: コード内の変数名、予約語、エラーメッセージの引用など、技術的に英語が必須な場合のみ例外とする。

---

## 1. 世界の定義 (Sandbox Protocol)

### 🔴 正の世界 (Production / Main)
- **対象ディレクトリ**: `src/views`, `src/components`, `src/composables` (※ `src/sandbox_mirror` を除くすべて)
- **役割**: 安定稼働する本番環境相当。
- **編集ルール**: **原則禁止 (Read-Only)**。
    - バグ修正やリファクタリングなど、ユーザーから明示的な指示（「正の世界を修正せよ」）があった場合のみ慎重に編集する。
    - 新機能の追加や実験は絶対に行ってはならない。

### 🟢 鏡の世界 (Development / Mirror)
- **対象ディレクトリ**: `src/sandbox_mirror/**` 全配下
- **対象URL**: `/sandbox_mirror/**`
- **役割**: 新機能開発、UI実験、複雑なロジック改修を行うプレイグラウンド。
- **編集ルール**: **自由 (Playground)**。
    - すべての新しいコードはここに書く。
    - 既存のコンポーネントを修正したい場合は、必ずこのディレクトリにコピーしてから編集する。

## 2. 開発ワークフロー

1.  **着手前確認**:
    - 編集しようとしているファイルパスを確認せよ。
    - それは `src/sandbox_mirror` の中か？
    - **No** ならば、直ちに作業を中断し、対象ファイルを `src/sandbox_mirror` 配下にコピー（移行）せよ。

2.  **機能実装**:
    - すべての実装は鏡の世界で行う。
    - `src/router/index.ts` に鏡の世界専用のルートを追加する。

3.  **ナビゲーションの隔離**:
    - 鏡の世界のコンポーネント内から、正の世界へのリンク（`router.push('/')` や `<router-link to="/clients">`）を貼ってはならない。
    - 必ず `/sandbox_mirror/...` へのリンクに書き換えるか、`App.vue` の `navigateTo` のようなコンテキスト認識型の遷移ロジックを使用する。
    - **正の世界への脱出はバグである**と認識せよ。

4.  **「マージ」の禁止**:
    - 鏡の世界で完成した機能を、安易に正の世界のファイルにコピペして上書きしてはならない。
    - 本番適用（プロモーション）は、ユーザーの明示的な許可と、厳密な手順書（Walkthrough）に基づいた手動移行によってのみ行われる。

## 3. 緊急時の対応

- **誤って正の世界を編集した場合**:
    1.  即座に謝罪し、変更をロールバックする。
    2.  変更内容を鏡の世界のファイルへ移動する。
    3.  ブラウザで正の世界が「元の状態」に戻っているか検証する。

---
**AIへの指示**:
新しいタスクを開始する際は、必ずこのファイル (`.agent/workflows/sandbox_strategy.md`) を読み込み、自分がどのファイルを編集しようとしているか自己監視せよ。
