# Use Case Workbook（Phase 3-A）

**作成日**: 2026-01-17  
**最終更新**: 2026-01-17  
**ステータス**: Phase 3-A作業中  
**関連**: property-integration-map.md, TASK_UI_RECONCILIATION.md

---

## このドキュメントの位置づけ

- **Phase 3-A**: 利用シーン棚卸し（Human Use-Case Layer）
- **目的**:
  - 業務の現場で「誰が・いつ・何のために・何を判断するか」を自然言語で固定する
  - プロパティの意味定義・実装判断は行わない
- **注意**:
  - プロパティ名・型・UI仕様・API仕様は書かない
  - 「数値が必要」「比較したい」「一覧で見たい」など**情報の性質**のみを書く

---

## このドキュメントは「プロパティの意味」を定義するものではない

人間の業務における**判断・行動・文脈（利用シーン）**を固定するためのワークブックである。

- プロパティ名・型・実装・DB・APIは一切記述しない
- 利用シーンは「意味定義表を網羅する」ためではない
- しかし「最終的に336プロパティが"どこかの利用シーンに必ず帰属する"密度」で書く

---

## 記述ルール（重要）

- 主語は必ず「人間」
- 判断・迷い・違和感を書く（理想論は禁止）
- 「正確さ」より「実務感」を優先
- UIを想像してよいが、UI構成は書かない

---

## 役割分担（厳守）

| 作業 | 担当 |
|------|------|
| プロパティ棚卸し | IDE |
| 問いへの変換 | IDE |
| **業務の語り** | **人間** |
| UseCase整形 | IDE |
| 意味確定 | Phase 3-C |

**IDE（私）への指示**:
> 「UseCaseを創作するな。
> 意味を定義するな。
> ただし、人間が語る業務文脈を
> 構造化して保持することに専念せよ。」

---

# Step 1: 業務判断が匂う項目（IDEが抽出）

以下は、property-integration-map.mdから抽出した「業務判断が匂う項目」です。

**これは問いの形に変換したもの**であり、UseCaseではありません。

人間は、この問いを眺めて「実際の現場を思い出し」、自然言語で業務を語ってください。

---

## Client関連: 業務判断を含みそうな項目

### 報酬・契約関連
**抽出項目**: `status`, `active`, `contractDate`, `fiscalMonth`, `accountingSoftware`

**問い**:
- 顧問先のステータス（active/inactive/suspension）は、いつ・誰が・何の判断に使うのか？
- 契約開始日は、請求判断なのか、作業可否判断なのか？
- 決算月は、税務処理のタイミング判断のみか、それとも別の用途もあるのか？

### Drive連携・フォルダ管理関連
**抽出項目**: `sharedFolderId`, `driveLinked`, `driveLinks.*`, `processingFolderId`, `archivedFolderId`

**問い**:
- Drive連携IDは、証憑管理目的か、監査対応目的か、それとも別の用途か？
- 連携状態（driveLinked）は、誰がどのタイミングで確認するのか？
- 処理中フォルダとアーカイブフォルダは、どの業務フローで使い分けるのか？

### 税務設定関連（PENDING項目）
**抽出項目**: `defaultTaxRate`, `taxMethod`, `isInvoiceRegistered`, `invoiceRegistrationNumber`, `roundingSettings`, `consumptionTaxMode`, `simplifiedTaxCategory`, `taxFilingType`

**問い**:
- これらの税務設定は、いつ・誰が・どのタイミングで参照するのか？
- インボイス登録の有無は、仕訳入力時に自動判定に使うのか、それとも月次レビュー時に確認するのか？
- 端数処理（floor/round/ceil）は、入力時に自動適用するのか、それとも確認・修正するのか？

### 担当者・連絡先関連
**抽出項目**: `staffName`, `type`, `contact.type`, `contact.value`, `담当자Id`

**問い**:
- 担当者名は、業務分担の判断に使うのか、それとも単なる記録か？
- 法人/個人（type）は、税務処理の自動判定に使うのか？
- 連絡先（email/chatwork/none）は、アラート送信先として使うのか？
- `담당자Id`（韓国語プロパティ）は、誰がどのように使っているのか？

---

## Job関連: 業務判断を含みそうな項目

### 業務状態・フロー制御
**抽出項目**: `status`, `priority`, `steps.*`, `journalEditMode`, `canEdit`, `isLocked`

**問い**:
- 仕訳状態（status）は、誰がどのタイミングで変更するのか？
- 優先度（high/normal/low）は、誰が設定し、誰が参照するのか？
- STEP 1-7の各ステップは、誰が・どの順番で・何を判断するのか？
- 編集モード（work/remand/approve/locked）は、どの業務フローで切り替わるのか？

### AI提案・信頼度
**抽出項目**: `confidenceScore`, `hasAiResult`, `aiProposal.*`, `invoiceValidationLog`

**問い**:
- AI信頼度は、どの閾値で「人間の確認が必要」と判断するのか？
- AI提案（aiProposal）は、自動採用するのか、それとも必ず人間がレビューするのか？
- インボイス検証ログは、誰がどのタイミングで確認するのか？

### アラート・エラー
**抽出項目**: `alerts`, `errorMessage`

**問い**:
- アラート（error/warning/info）は、誰に通知され、誰が対応するのか？
- エラーメッセージは、スタッフが自己解決できるレベルか、それとも上長判断が必要か？

### AI使用統計・コスト管理
**抽出項目**: `aiUsageStats.inputTokens`, `aiUsageStats.outputTokens`, `aiUsageStats.estimatedCostUsd`, `aiUsageStats.modelName`

**問い**:
- AI使用統計は、誰が・どのタイミングで確認するのか？
- 推定コスト（USD）は、月次レビューで使うのか、それともリアルタイムで監視するのか？

---

## Admin/System関連: 業務判断を含みそうな項目（最大論点）

### Phase別AI設定（公開のみ存在）
**抽出項目**: `phase1_aiProvider`, `phase1_processingMode`, `phase2_aiProvider`, `phase2_processingMode`

**問い**:
- Phase分離の意図は何か？（Phase 1/2で異なるAI Provider使用など）
- 処理モード（通常 / Batch API）は、どの業務フローで切り替えるのか？
- これらの設定は、誰が・どのタイミングで変更するのか？

### GCS Bucket設定（公開のみ存在）
**抽出項目**: `gcsBucketInput`, `gcsBucketOutput`

**問い**:
- GCS Bucketは、証憑アップロード時に自動使用されるのか？
- Input/Outputの分離は、どの業務フローで必要なのか？

### ジョブ間隔設定（ローカルのみ存在）
**抽出項目**: `jobRegistrationInterval`, `jobExecutionInterval`

**問い**:
- ジョブ登録間隔（15分等）は、業務の即応性にどう影響するのか？
- これらの設定は、本番環境で必要か？それとも開発専用か？

### コスト計算設定（ローカルのみ存在）
**抽出項目**: `exchangeRate`, `apiInputPrice`

**問い**:
- 為替レートは、リアルタイムで自動取得するのか、それとも手動設定か？
- API単価は、どの業務判断に使うのか？（月次コストレビュー等）

### 開発専用設定（ローカルのみ存在）
**抽出項目**: `apiKey`, `debugMode`

**問い**:
- これらは本番環境では削除すべきか？
- 環境変数に移行すべきか？

---

## Screen C-H関連: 業務判断を含みそうな項目

### Screen C（資料回収状況）
**抽出項目**: `monthlyStatus（24ヶ月）`, `banks`, `creditCards`, `materialStatuses`, `c_config`

**問い**:
- 24ヶ月分の月別回収状態は、誰が・どのタイミングで確認するのか？
- 銀行口座・クレジットカードのステータス（connected/error）は、アラート対象か？
- クイック設定（cash/payroll/social/invoice監視ON/OFF）は、顧問先ごとにカスタマイズするのか？

### Screen D（AIルール）
**抽出項目**: `priority`, `condition`, `result`, `status`, `usageCount`

**問い**:
- AIルールの優先度は、複数ルールが競合した時にどう判定するのか？
- 適用回数（usageCount）は、ルールの有効性を判断する指標として使うのか？

### Screen G（データ変換）
**抽出項目**: `clientName`, `sourceSoftware`, `targetSoftware`, `logs`

**問い**:
- 変換履歴（logs）は、誰が・どのタイミングで確認するのか？
- エラー時の再実行は、誰が判断するのか？

### Screen H（タスクダッシュボード）
**抽出項目**: `missingCount`, `alertCount`, `draftCount`, `approvalCount`, `exportCount`, `filingCount`, `learningCount`, `reconcileCount`

**問い**:
- 各タスクカウントは、誰が・どの頻度で確認するのか？
- アラート件数が増えた時、誰が対応するのか？

---

# Step 2: 人間が業務を語る（ここから人間の作業）

**上記の「問い」を眺めて、実際の現場を思い出してください。**

以下のフォーマットで、自然言語で業務を語ってください。
prototypeとして3つのUseCaseを記載しています。

---

## UseCase-CL-01

【業務エンティティ】
- Client（顧問先）

【主体】
- 記帳代行スタッフ（会計事務所）

【タイミング】
- 月次処理の終盤
- 当月分の仕訳入力が一通り終わった後

【目的】
- 今月の作業量が想定と比べて多かったか少なかったかを把握したい

【行動】
- 自分が担当している顧問先を一覧で眺める
- 「今月しんどかった顧問先」を感覚的に思い出す

【判断】
- 明らかに工数が多すぎる顧問先はあるか
- 来月、上長に相談すべき顧問先はどれか

【この場面で"無いと困る"情報】
- 顧問先ごとの作業量の目安（厳密でなくてよい）
- 前月や通常月との比較ができる要素

【あっても良いが必須ではない情報】
- 金額ベースの正確な採算
- 担当者以外の詳細情報

【補足・違和感】
- 数値が正確すぎると逆に使われない
- 一覧で「重い」「軽い」が直感的に分かる方が助かる

---

## UseCase-ST-02

【業務エンティティ】
- Staff（担当者）

【主体】
- マネージャー（レビュー者）

【タイミング】
- 月次レビュー前
- スタッフからの「大変だった」報告を受けた後

【目的】
- 作業量の偏りが常態化していないかを確認したい

【行動】
- 複数スタッフの状況をざっと比較する
- 特定のスタッフに業務が集中していないかを見る

【判断】
- 業務分担を見直す必要があるか
- 顧問先側の条件を変更すべきか

【この場面で"無いと困る"情報】
- スタッフごとの負荷の傾向
- 一時的な増加か、継続的な問題かが分かる要素

【あっても良いが必須ではない情報】
- 個別作業の詳細ログ
- 秒単位の正確な時間

---

## UseCase-TX-03

【業務エンティティ】
- Transaction（取引・領収書）

【主体】
- 記帳代行スタッフ

【タイミング】
- 証憑アップロード直後
- 仕訳入力前

【目的】
- 処理対象として問題のある取引を早めに見つけたい

【行動】
- 取り込まれた証憑をざっと確認する
- 違和感のあるものを後回しにする

【判断】
- 重複していそうな証憑はあるか
- 期間外・私的利用の可能性があるか

【この場面で"無いと困る"情報】
- 「怪しい」と気づけるフラグや傾向
- 後で確認すべきものが分かる状態

【あっても良いが必須ではない情報】
- OCR結果の完全な正確性
- 自動仕訳の確定結果

---

## メモ・追加UseCase（自由記述）

（ここに自由にUseCaseを追加してください）

---

**作成日**: 2026-01-17  
**ステータス**: Phase 3-A作業中  
**次ステップ**: 人間がUseCaseを追記 → Phase 3-B（UIモック）
