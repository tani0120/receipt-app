# 未解決議論・中断した議論（2026-01-21）

**作成日**: 2026-01-21  
**最終更新**: 2026-01-21  
**ステータス**: Active  
**目的**: セッション中に中断・保留した議論を明示的に記録し、次回セッションで再開可能にする

---

## 📋 中断した議論

### 1. 開発用Firebaseプロジェクト作成

**議論の経緯**:
- 本番データ保護のため、開発用Firebaseプロジェクト（`sugu-suru-dev`）作成を提案
- `implementation_plan.md`に詳細な手順を作成
- ユーザーから「本番データがまだないので不要」との判断
- → **中断**

**理由**:
本番データがまだ存在しないため、環境分離の必要性がない

**再開条件**:
- 本番環境に顧問先の実際のデータが追加されたとき
- 機密情報（領収書等）を扱い始めたとき

**記録先**:
- `brain/implementation_plan.md`（セッション固有）
- → 削除または「不要と判断」を明記して保持

**次のアクション**:
- 本番データ追加時に再検討
- 必要になったら、`implementation_plan.md`を参照して実施

---

### 2. バックエンドアーキテクチャ実装計画

**議論の経緯**:
- 当初「Firestore直接アクセスで問題ない」と判断
- ユーザーから以下の指摘：
  - AI処理が必要（Gemini API呼び出し）
  - 複雑な集計処理が必要
  - バッチ処理が必要
  - 機密情報を扱う（顧問先の領収書等）
- SYSTEM_PHILOSOPHY.mdを確認：
  - **GAS (Google Apps Script)**: Google Driveファイル操作 + AI解析バッチ + ファイル移動
  - **現状**: VueアプリのMock/Service層でシミュレーション中
- → **結論**: GASが必要だが、実装計画は未定

**問題点**:
- GASをいつ、どのように実装するか未定義
- `src/server.ts`、`src/api/`の扱いが曖昧（Mockなのか、本番用なのか）

**再開条件**:
- AI解析バッチ実装が必要になったとき
- Google Driveのファイル操作が必要になったとき

**記録先**:
- SYSTEM_PHILOSOPHY.md（GASの役割は既に明記済み）
- 実装計画: 将来作成すべき

**次のアクション**:
- ADR-008: バックエンドアーキテクチャ戦略（GAS vs Node.js）を作成すべきか検討
- または、TASK_MASTER.mdに「GAS実装」タスクを追加

---

## 📋 保留した判断

### 3. セッション管理プロトコル改善

**議論の経緯**:
- セッション開始・終了のファイル更新にブレがある問題を指摘
- 改善案A/B/Cを提示：
  - **改善案A（推奨）**: 最小セット + 段階的拡張
  - **改善案B（保守的）**: 完全チェックリスト方式
  - **改善案C**: ハ イブリッド方式
- → **承認待ち**

**提案ドキュメント**:
- `brain/session-protocol-improvement.md`（作成済み）

**問題点**:
- 承認されていないため、まだ適用されていない
- 今回のセッション終了時にどのプロトコルで進めるか未定

**再開条件**:
- ユーザー承認後

**次のアクション**:
- 次回セッション開始時に再確認
- 承認されたら、session-management-protocol-complete.mdを更新

---

## 📋 ADR作成検討（結論: 不要）

### Firebase認証戦略

**議論**:
ADR-008: Firebase認証戦略を作成すべきか？

**判定**:
```
判定チェック:
- アーキテクチャの根本的変更？
  → No（認証層追加だが、既存アーキテクチャの延長）
  
- 開発原則の確立？
  → No（既存の原則に従っているだけ）
  
- 技術選定の重要判断？
  → Yes（Firebase Authを採用）
  → しかし、Firebaseは既に採用済み（Firestore使用中）
  → 追加機能の利用なので、ADRレベルではない
  
結論: SYSTEM_PHILOSOPHY.mdに記録（ADR不要）
```

**対応**:
- SYSTEM_PHILOSOPHY.md + CHANGELOG_SYSTEM_PHILOSOPHY.mdに記録
- ADR作成は不要

---

### 4. セッション開始プロトコルの修正 ✅ **解決済み（2026-01-21 23:40）**

**議論の経緯**:
- session-management-protocol-complete.mdにSESSION_CHECKLIST.md作成を追加しようとした
- セッション開始プロトコルの修正を試みたが、**追加に失敗**
- → **2026-01-21 23:40に修正完了**

**解決内容**:
- ✅ セッション開始プロトコルのStep 0にSESSION_CHECKLIST.md作成を明記
- ✅ ADR-004/005/006の記載は維持（削除されていなかった）
- ✅ SESSION_CHECKLIST.md作成の重要性を明記（短期記憶問題対策）

**状態**: **完了**

---

## 更新履歴

- **2026-01-22 00:26**: 5件目追加（小さく開発への方針転換）
- **2026-01-21 23:40**: 4件目を解決済みに更新（セッション開始プロトコル修正完了）
- **2026-01-21 23:33**: 4件目追加（セッション開始プロトコル修正未完了）
- **2026-01-21**: 初版作成（Firebase認証設定セッション）

---

## 📋 保留した判断（追加）

### 5. 小さく開発への方針転換

**議論の経緯**:
- 現在のシステムは複雑すぎて実装に時間がかかる
- Phase 3-B（UIモック29件）は範囲が大きすぎる
- 仕訳UI + 顧問先登録UIに絞って小さく開発すべきでは？
- → **方針転換を提案**

**提案内容**:
1. **MVP Scope**:
   - 仕訳UI（領収書1枚 → 仕訳1件の最小フロー）
   - 顧問先登録UI（顧問先名、基本情報のみ）
   - 学習ルール簡易版（勘定科目の固定マッピングのみ）

2. **L4/L5の扱い**:
   - L4/L5を「凍結」（作らないのではなく、段階的に硬化）
   - Layer A/B/Cの組み合わせで代替：
     - **Layer A**: 段階的確認 + console.log（技術的エラー排除）
     - **Layer B**: Mapping Table（L4代替、責任所在の明確化）
     - **Layer C**: Service単体テスト + 型での禁止（L5代替、呼び出し制約）

3. **過去の痛みへの対応**:
   - ADR-005, ADR-006を「過去の失敗ログ」として読む
   - 「表示されない、何が壊れてるかわからない、デバッグ不能」を回避
   - Layer A単独では不十分、Layer B/Cが必須

**再開条件**:
- ADR-008作成後、正式に方針転換
- implementation_plan.md作成（Layer A/B/C詳細設計）

**記録先**:
- ADR-008: 小さく開発への方針転換（次回セッションで作成）
- implementation_plan.md（詳細設計、5日間スケジュール）

**次のアクション**:
1. **必須**: ADR-005, ADR-006を読む（1時間）
2. **必須**: ADR-008作成（1時間）
3. **必須**: implementation_plan.md作成（2時間）
4. **推奨**: UseCaseの絞り込み（207件 → 10件程度）
5. **推奨**: Mapping Tableテンプレート作成

**優先度**: **高**（Phase 3-Bの代わりに実施）

**次回対応**: ✅ **次回セッションで対応予定**（2026-01-22承認）

**議論の重要性**:
- L4/L5の本質理解（「意味と画面の束縛」「意味の不変性保証」）
- 過去の失敗（表示されない、デバッグ不能）の根本原因理解
- Layer A/B/Cの組み合わせによる段階的実装戦略

---
