
> ai-accounting@0.0.0 test
> vitest --run


[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90mC:/Users/kazen/OneDrive/繝・せ繧ｯ繝医ャ繝・ai_gogleanti[39m

 [32m笨・[39m src/composables/__tests__/DataConversionMapper.spec.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32m笨・[39m src/features/receipt/__tests__/ReceiptSemanticGuard.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32m笨・[39m src/composables/__tests__/JournalStatusMapper.spec.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [32m笨・[39m src/features/client/__tests__/ClientSemanticGuard.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32m笨・[39m src/features/client/__tests__/clientStateMachine.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32m笨・[39m src/features/receipt/__tests__/receiptStateMachine.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [31m笶ｯ[39m src/composables/__tests__/ClientMapper.spec.ts [2m([22m[2m4 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 10[2mms[22m[39m
     [32m笨・[39m Ironclad Rule 1: Exterminate Null/Undefined - Should return safe defaults[32m 2[2mms[22m[39m
     [32m笨・[39m Ironclad Rule 2: Folder IDs Preservation - Should never return null/undefined for folders[32m 0[2mms[22m[39m
     [32m笨・[39m Ironclad Rule 3: Enum & Logic Mapping - Should handle Tax Categories safely[32m 0[2mms[22m[39m
[31m     [31mﾃ・[31m Ironclad Rule 3b: Enum Fallback - Should handle unknown/null Tax Categories[39m[32m 6[2mms[22m[39m
 [32m笨・[39m src/__tests__/ClientMapper.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32m笨・[39m src/composables/__tests__/ClientDetailMapper.spec.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32m笨・[39m src/utils/__tests__/schema-mapper.spec.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [31m笶ｯ[39m src/features/client/__tests__/ClientSchema.test.ts [2m([22m[2m6 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 12[2mms[22m[39m
[31m     [31mﾃ・[31m 譛牙柑縺ｪClient繧貞女縺大・繧後ｋ[39m[32m 7[2mms[22m[39m
     [32m笨・[39m name 縺檎ｩｺ譁・ｭ励〒繧ｨ繝ｩ繝ｼ[32m 1[2mms[22m[39m
     [32m笨・[39m 諡・ｽ楢・d 縺袈UID縺ｧ縺ｪ縺・ｴ蜷医お繝ｩ繝ｼ[32m 0[2mms[22m[39m
     [32m笨・[39m status 縺・Draft 縺ｧ繧ｨ繝ｩ繝ｼ・・1縺ｯDraft繧呈桶繧上↑縺・ｼ・[32m 1[2mms[22m[39m
     [32m笨・[39m 蠢・医ヵ繧｣繝ｼ繝ｫ繝画ｬ關ｽ縺ｧ繧ｨ繝ｩ繝ｼ[32m 1[2mms[22m[39m
     [32m笨・[39m active 縺恵oolean莉･螟悶〒繧ｨ繝ｩ繝ｼ[32m 0[2mms[22m[39m
 [31m笶ｯ[39m src/features/receipt/__tests__/ReceiptSchema.test.ts [2m([22m[2m8 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 12[2mms[22m[39m
     [32m笨・[39m 譛牙柑縺ｪ譏守ｴｰ陦後ｒ蜿励￠蜈･繧後ｋ[32m 3[2mms[22m[39m
     [32m笨・[39m 蠢・医ヵ繧｣繝ｼ繝ｫ繝画ｬ關ｽ縺ｧ繧ｨ繝ｩ繝ｼ[32m 1[2mms[22m[39m
     [32m笨・[39m 蛟滓婿/雋ｸ譁ｹ莉･螟悶〒繧ｨ繝ｩ繝ｼ[32m 0[2mms[22m[39m
[31m     [31mﾃ・[31m 譛牙柑縺ｪReceipt繧貞女縺大・繧後ｋ[39m[32m 5[2mms[22m[39m
     [32m笨・[39m lines 縺檎ｩｺ驟榊・縺ｧ繧ｨ繝ｩ繝ｼ[32m 0[2mms[22m[39m
     [32m笨・[39m confidence 縺檎ｯ・峇螟悶〒繧ｨ繝ｩ繝ｼ[32m 0[2mms[22m[39m
     [32m笨・[39m status 縺・Draft 縺ｧ繧ｨ繝ｩ繝ｼ・・1縺ｯDraft繧呈桶繧上↑縺・ｼ・[32m 0[2mms[22m[39m
     [32m笨・[39m 蠢・医ヵ繧｣繝ｼ繝ｫ繝画ｬ關ｽ縺ｧ繧ｨ繝ｩ繝ｼ[32m 0[2mms[22m[39m
 [31m笶ｯ[39m src/features/receipt/__tests__/index.test.ts [2m([22m[2m9 tests[22m[2m | [22m[31m5 failed[39m[2m)[22m[32m 14[2mms[22m[39m
[31m     [31mﾃ・[31m 譛蟆城剞縺ｮDraft繧剃ｽ懈・縺ｧ縺阪ｋ[39m[32m 5[2mms[22m[39m
     [32m笨・[39m 荳肴ｭ｣縺ｪ讒矩縺ｧZodError[32m 1[2mms[22m[39m
[31m     [31mﾃ・[31m 譛牙柑縺ｪDraft繧担ubmitted縺ｫ螟画鋤縺ｧ縺阪ｋ[39m[32m 2[2mms[22m[39m
     [32m笨・[39m L1: 荳榊ｮ悟・縺ｪDraft縺ｧZodError[32m 0[2mms[22m[39m
[31m     [31mﾃ・[31m L2: 雋ｸ蛟滉ｸ堺ｸ閾ｴ縺ｧBusinessRuleError[39m[32m 2[2mms[22m[39m
[31m     [31mﾃ・[31m L2: 菫｡鬆ｼ蠎ｦ荳崎ｶｳ縺ｧBusinessRuleError[39m[32m 1[2mms[22m[39m
     [32m笨・[39m Submitted 竊・Approved 縺ｯ謌仙粥[32m 0[2mms[22m[39m
     [32m笨・[39m L3: Approved 竊・Submitted 縺ｯ遖∵ｭ｢[32m 0[2mms[22m[39m
[31m     [31mﾃ・[31m Draft 竊・Submit 竊・Approve 縺ｮ螳悟・縺ｪ豬√ｌ[39m[32m 1[2mms[22m[39m
 [32m笨・[39m src/composables/__tests__/AIRulesMapper.spec.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32m笨・[39m src/__tests__/JobMapper.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [31m笶ｯ[39m src/composables/__tests__/JobMapper.spec.ts [2m([22m[2m5 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 12[2mms[22m[39m
[31m     [31mﾃ・[31m Ironclad Rule 1: Exterminate Null/Undefined - Should return safe defaults for missing fields[39m[32m 9[2mms[22m[39m
     [32m笨・[39m Ironclad Rule 2: Date Safety - Should convert Timestamp to formatted string[32m 1[2mms[22m[39m
     [32m笨・[39m Ironclad Rule 3: Business Logic - Should handle unknown tax rates safely[32m 0[2mms[22m[39m
     [32m笨・[39m Ironclad Rule 3: Status Aggregation - Should map unknown status to safe fallback[32m 0[2mms[22m[39m
     [32m笨・[39m Ironclad Rule 4: Deep Structure - Should flatten or safeguard nested objects[32m 0[2mms[22m[39m
node.exe : 
発生場所 行:1 文字:1
+ & "C:\Program Files\nodejs/node.ex
e" "C:\Program Files\nodejs/node_mo 
...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSp 
   ecified: (:String) [], RemoteEx  
  ception
    + FullyQualifiedErrorId : Nativ 
   eCommandError
 
[31m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[39m[1m[41m Fail
ed Suites 2 [49m[22m[31m竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ[39m

[41m[1m FAIL [22m[49m src/compos
ables/__tests__/LearningRuleMapper.s
pec.ts[2m [ src/composables/__tests
__/LearningRuleMapper.spec.ts ][22m
[31m[1mError[22m: Cannot find pac
kage '@/composables/LearningRuleMapp
er' imported from 'C:/Users/kazen/On
eDrive/繝・せ繧ｯ繝医ャ繝・ai_gogleanti/src/co
mposables/__tests__/LearningRuleMapp
er.spec.ts'[39m
[36m [2m笶ｯ[22m src/composables/__
tests__/LearningRuleMapper.spec.ts:
[2m3:1[22m[39m
    [90m  1| [39m[35mimport[39m 
{ describe[33m,[39m it[33m,[39m 
expect } [35mfrom[39m [32m'vitest
'[39m[33m;[39m
    [90m  2| [39m[35mimport[39m 
type { [33mLearningRuleApi[39m } 
[35mfrom[39m [32m'@/types/zod.type
'[39m[33m;[39m
    [90m  3| [39mimport { mapLearn
ingRuleApiToUi } from '@/composables
/LearningRuleMapp窶ｦ
    [90m   | [39m[31m^[39m
    [90m  4| [39m
    [90m  5| [39m[34mdescribe[39
m([32m'LearningRuleMapper Constitut
ion (Ironclad Rules)'[39m[33m,[39
m () [33m=>[39m {

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[1/11]竡ｯ[22m[39
m

[41m[1m FAIL [22m[49m src/servic
es/__tests__/LogicSelector.spec.ts[
2m [ src/services/__tests__/LogicSel
ector.spec.ts ][22m
[31m[1mError[22m: Cannot find pac
kage '@/mappings/ocr-to-accounting' 
imported from 'C:/Users/kazen/OneDri
ve/繝・せ繧ｯ繝医ャ繝・ai_gogleanti/src/servic
es/LogicSelector.ts'[39m
[36m [2m笶ｯ[22m src/services/Logic
Selector.ts:[2m14:1[22m[39m
    [90m 12| [39m
    [90m 13| [39m[35mimport[39m 
{ createMapper } [35mfrom[39m [32
m'@/utils/schema-mapper'[39m[33m;
[39m
    [90m 14| [39m[35mimport[39m 
{
    [90m   | [39m[31m^[39m
    [90m 15| [39m    [33mMappings
[39m[33m,[39m
    [90m 16| [39m    [33mOCRStrat
egy[39m[33m,[39m
[90m [2m笶ｯ[22m src/services/__tes
ts__/LogicSelector.spec.ts:[2m8:1[
22m[39m

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[2/11]竡ｯ[22m[39
m


[31m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[39m[1m[41m Fa
iled Tests 9 [49m[22m[31m竡ｯ竡ｯ竡ｯ竡ｯ
竡ｯ竡ｯ竡ｯ[39m

[41m[1m FAIL [22m[49m src/compos
ables/__tests__/ClientMapper.spec.ts
[2m > [22mClientMapper Constitutio
n (Ironclad Rules)[2m > [22mIroncl
ad Rule 3b: Enum Fallback - Should h
andle unknown/null Tax Categories
[31m[1mAssertionError[22m: expect
ed undefined to be +0 // Object.is e
quality[39m

[32m- Expected:[39m 
0

[31m+ Received:[39m 
undefined

[36m [2m笶ｯ[22m src/composables/__
tests__/ClientMapper.spec.ts:[2m59:
42[22m[39m
    [90m 57| [39m        [35mcons
t[39m ui [33m=[39m [34mmapClient
ApiToUi[39m(apiWithNullTax [35mas
[39m [33mClientApi[39m)[33m;[39m
    [90m 58| [39m
    [90m 59| [39m        [34mexpe
ct[39m(ui[33m.[39msimplifiedTaxCa
tegory)[33m.[39m[34mtoBe[39m([3
4m0[39m)[33m;[39m [90m// 0 = Non
e[39m
    [90m   | [39m                 
                        [31m^[39m
    [90m 60| [39m        expect(ui
.simplifiedTaxCategoryLabel).toBe('迚
ｹ縺ｫ縺ｪ縺・); // or "蜴溷援隱ｲ窶ｦ
    [90m 61| [39m    })[33m;[39m

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[3/11]竡ｯ[22m[39
m

[41m[1m FAIL [22m[49m src/compos
ables/__tests__/JobMapper.spec.ts[2
m > [22mJobMapper Constitution (Iro
nclad Rules)[2m > [22mIronclad Rul
e 1: Exterminate Null/Undefined - Sh
ould return safe defaults for missin
g fields
[31m[1mAssertionError[22m: expect
ed 'unknown' to be '' // Object.is e
quality[39m

[32m- Expected[39m
[31m+ Received[39m

[31m+ unknown[39m

[36m [2m笶ｯ[22m src/composables/__
tests__/JobMapper.spec.ts:[2m29:27
[22m[39m
    [90m 27| [39m    [90m// Asser
tions: UI Types must be safe[39m
    [90m 28| [39m    [34mexpect[
39m(ui[33m.[39mid)[33m.[39m[34m
toBe[39m([32m'job_broken'[39m)[3
3m;[39m
    [90m 29| [39m    [34mexpect[
39m(ui[33m.[39mclientCode)[33m.[
39m[34mtoBe[39m([32m''[39m)[33m
;[39m [90m// Default string[39m
    [90m   | [39m                 
         [31m^[39m
    [90m 30| [39m    [34mexpect[
39m(ui[33m.[39mstatus)[33m.[39m
[34mtoBe[39m([32m'unknown'[39m)[
33m;[39m [90m// Safe Enum Fallback
[39m
    [90m 31| [39m    [34mexpect[
39m(ui[33m.[39mlines)[33m.[39m[
34mtoEqual[39m([])[33m;[39m [90m
// Empty Array, not undefined[39m

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[4/11]竡ｯ[22m[39
m

[41m[1m FAIL [22m[49m src/featur
es/client/__tests__/ClientSchema.tes
t.ts[2m > [22mL1: Zod Guard - Clie
ntSchema・育｢ｺ螳咾lient縺ｮ縺ｿ・・[2m > [22m
譛牙柑縺ｪClient繧貞女縺大・繧後ｋ
[31m[1mAssertionError[22m: expect
ed [Function] to not throw an error 
but '[\n  {\n    "origin": "string",
\n    窶ｦ' was thrown[39m

[32m- Expected:[39m 
undefined

[31m+ Received:[39m 
"[
  {
    \"origin\": \"string\",
    \"code\": \"invalid_format\",
    \"format\": \"uuid\",
    \"pattern\": \"/^([0-9a-fA-F]{8}
-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-
[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{1
2}|00000000-0000-0000-0000-000000000
000|ffffffff-ffff-ffff-ffff-ffffffff
ffff)$/\",
    \"path\": [
      \"id\"
    ],
    \"message\": \"Invalid UUID\"
  },
  {
    \"origin\": \"string\",
    \"code\": \"invalid_format\",
    \"format\": \"uuid\",
    \"pattern\": \"/^([0-9a-fA-F]{8}
-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-
[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{1
2}|00000000-0000-0000-0000-000000000
000|ffffffff-ffff-ffff-ffff-ffffffff
ffff)$/\",
    \"path\": [
      \"諡・ｽ楢・d\"
    ],
    \"message\": \"Invalid UUID\"
  }
]"

[36m [2m笶ｯ[22m src/features/clien
t/__tests__/ClientSchema.test.ts:[2
m22:59[22m[39m
    [90m 20| [39m
    [90m 21| [39m    [34mit[39m(
[32m"譛牙柑縺ｪClient繧貞女縺大・繧後ｋ"[39m[33
m,[39m () [33m=>[39m {
    [90m 22| [39m        [34mexpe
ct[39m(() [33m=>[39m [33mClientS
chema[39m[33m.[39m[34mparse[39m
(validClient))[33m.[39mnot[33m.[
39m[34mtoThrow[39m()[33m;[39m
    [90m   | [39m                 
                                    
     [31m^[39m
    [90m 23| [39m    })[33m;[39m
    [90m 24| [39m

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[5/11]竡ｯ[22m[39
m

[41m[1m FAIL [22m[49m src/featur
es/receipt/__tests__/index.test.ts[
2m > [22mPenta-Shield Pipeline - cr
eateDraftReceipt[2m > [22m譛蟆城剞縺ｮD
raft繧剃ｽ懈・縺ｧ縺阪ｋ
[31m[1mZodError[22m: [
  {
    "origin": "string",
    "code": "invalid_format",
    "format": "uuid",
    "pattern": "/^([0-9a-fA-F]{8}-[0
-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89
abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|
00000000-0000-0000-0000-000000000000
|ffffffff-ffff-ffff-ffff-fffffffffff
f)$/",
    "path": [
      "id"
    ],
    "message": "Invalid UUID"
  }
][39m
[36m [2m笶ｯ[22m createDraftReceipt
 src/features/receipt/index.ts:[2m2
0:31[22m[39m
    [90m 18| [39m */[39m
    [90m 19| [39m[35mexport[39m 
[35mfunction[39m [34mcreateDraftR
eceipt[39m(input[33m:[39m unknown
)[33m:[39m [33mReceiptDraft[39m 
{
    [90m 20| [39m    [35mreturn[
39m [33mReceiptDraftSchema[39m[33
m.[39m[34mparse[39m(input)[33m;
[39m
    [90m   | [39m                 
             [31m^[39m
    [90m 21| [39m}
    [90m 22| [39m
[90m [2m笶ｯ[22m src/features/recei
pt/__tests__/index.test.ts:[2m18:23
[22m[39m

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[6/11]竡ｯ[22m[39
m

[41m[1m FAIL [22m[49m src/featur
es/receipt/__tests__/index.test.ts[
2m > [22mPenta-Shield Pipeline - su
bmitReceipt・磯未髢・・[2m > [22m譛牙柑縺ｪDr
aft繧担ubmitted縺ｫ螟画鋤縺ｧ縺阪ｋ
[31m[1mZodError[22m: [
  {
    "origin": "string",
    "code": "invalid_format",
    "format": "uuid",
    "pattern": "/^([0-9a-fA-F]{8}-[0
-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89
abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|
00000000-0000-0000-0000-000000000000
|ffffffff-ffff-ffff-ffff-fffffffffff
f)$/",
    "path": [
      "id"
    ],
    "message": "Invalid UUID"
  }
][39m
[36m [2m笶ｯ[22m submitReceipt src/
features/receipt/index.ts:[2m39:34
[22m[39m
    [90m 37| [39m
    [90m 38| [39m    [90m// L1: 讒
矩讀懆ｨｼ[39m
    [90m 39| [39m    [35mconst[3
9m parsed [33m=[39m [33mReceiptSc
hema[39m[33m.[39m[34mparse[39m(
submittedData)[33m;[39m
    [90m   | [39m                 
                [31m^[39m
    [90m 40| [39m
    [90m 41| [39m    [90m// L2: 讌
ｭ蜍呎､懆ｨｼ[39m
[90m [2m笶ｯ[22m src/features/recei
pt/__tests__/index.test.ts:[2m45:25
[22m[39m

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[7/11]竡ｯ[22m[39
m

[41m[1m FAIL [22m[49m src/featur
es/receipt/__tests__/index.test.ts[
2m > [22mPenta-Shield Pipeline - su
bmitReceipt・磯未髢・・[2m > [22mL2: 雋ｸ蛟
滉ｸ堺ｸ閾ｴ縺ｧBusinessRuleError
[31m[1mAssertionError[22m: expect
ed error to be instance of BusinessR
uleError[39m

[32m- Expected:[39m 
[Function BusinessRuleError]

[31m+ Received:[39m 
ZodError {
  "message": "[
  {
    \"origin\": \"string\",
    \"code\": \"invalid_format\",
    \"format\": \"uuid\",
    \"pattern\": \"/^([0-9a-fA-F]{8}
-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-
[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{1
2}|00000000-0000-0000-0000-000000000
000|ffffffff-ffff-ffff-ffff-ffffffff
ffff)$/\",
    \"path\": [
      \"id\"
    ],
    \"message\": \"Invalid UUID\"
  }
]",
  "name": "ZodError",
}

[36m [2m笶ｯ[22m src/features/recei
pt/__tests__/index.test.ts:[2m67:54
[22m[39m
    [90m 65| [39m        }[33m;[
39m
    [90m 66| [39m
    [90m 67| [39m        expect(()
 => submitReceipt(unbalancedDraft)).
toThrow(BusinessR窶ｦ
    [90m   | [39m                 
                                    
[31m^[39m
    [90m 68| [39m    })[33m;[39m
    [90m 69| [39m

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[8/11]竡ｯ[22m[39
m

[41m[1m FAIL [22m[49m src/featur
es/receipt/__tests__/index.test.ts[
2m > [22mPenta-Shield Pipeline - su
bmitReceipt・磯未髢・・[2m > [22mL2: 菫｡鬆
ｼ蠎ｦ荳崎ｶｳ縺ｧBusinessRuleError
[31m[1mAssertionError[22m: expect
ed error to be instance of BusinessR
uleError[39m

[32m- Expected:[39m 
[Function BusinessRuleError]

[31m+ Received:[39m 
ZodError {
  "message": "[
  {
    \"origin\": \"string\",
    \"code\": \"invalid_format\",
    \"format\": \"uuid\",
    \"pattern\": \"/^([0-9a-fA-F]{8}
-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-
[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{1
2}|00000000-0000-0000-0000-000000000
000|ffffffff-ffff-ffff-ffff-ffffffff
ffff)$/\",
    \"path\": [
      \"id\"
    ],
    \"message\": \"Invalid UUID\"
  }
]",
  "name": "ZodError",
}

[36m [2m笶ｯ[22m src/features/recei
pt/__tests__/index.test.ts:[2m76:57
[22m[39m
    [90m 74| [39m        }[33m;[
39m
    [90m 75| [39m
    [90m 76| [39m        expect(()
 => submitReceipt(lowConfidenceDraft
)).toThrow(Busine窶ｦ
    [90m   | [39m                 
                                    
   [31m^[39m
    [90m 77| [39m    })[33m;[39m
    [90m 78| [39m})[33m;[39m

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[9/11]竡ｯ[22m[39
m

[41m[1m FAIL [22m[49m src/featur
es/receipt/__tests__/index.test.ts[
2m > [22mPenta-Shield Pipeline - 螳悟
・縺ｪ豬√ｌ[2m > [22mDraft 竊・Submit 竊・A
pprove 縺ｮ螳悟・縺ｪ豬√ｌ
[31m[1mZodError[22m: [
  {
    "origin": "string",
    "code": "invalid_format",
    "format": "uuid",
    "pattern": "/^([0-9a-fA-F]{8}-[0
-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89
abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|
00000000-0000-0000-0000-000000000000
|ffffffff-ffff-ffff-ffff-fffffffffff
f)$/",
    "path": [
      "id"
    ],
    "message": "Invalid UUID"
  }
][39m
[36m [2m笶ｯ[22m createDraftReceipt
 src/features/receipt/index.ts:[2m2
0:31[22m[39m
    [90m 18| [39m */[39m
    [90m 19| [39m[35mexport[39m 
[35mfunction[39m [34mcreateDraftR
eceipt[39m(input[33m:[39m unknown
)[33m:[39m [33mReceiptDraft[39m 
{
    [90m 20| [39m    [35mreturn[
39m [33mReceiptDraftSchema[39m[33
m.[39m[34mparse[39m(input)[33m;
[39m
    [90m   | [39m                 
             [31m^[39m
    [90m 21| [39m}
    [90m 22| [39m
[90m [2m笶ｯ[22m src/features/recei
pt/__tests__/index.test.ts:[2m114:2
3[22m[39m

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[10/11]竡ｯ[22m[39m

[41m[1m FAIL [22m[49m src/featur
es/receipt/__tests__/ReceiptSchema.t
est.ts[2m > [22mL1: Zod Guard - Re
ceiptSchema・育｢ｺ螳啌eceipt縺ｮ縺ｿ・・[2m > 
[22m譛牙柑縺ｪReceipt繧貞女縺大・繧後ｋ
[31m[1mAssertionError[22m: expect
ed [Function] to not throw an error 
but '[\n  {\n    "origin": "string",
\n    窶ｦ' was thrown[39m

[32m- Expected:[39m 
undefined

[31m+ Received:[39m 
"[
  {
    \"origin\": \"string\",
    \"code\": \"invalid_format\",
    \"format\": \"uuid\",
    \"pattern\": \"/^([0-9a-fA-F]{8}
-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-
[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{1
2}|00000000-0000-0000-0000-000000000
000|ffffffff-ffff-ffff-ffff-ffffffff
ffff)$/\",
    \"path\": [
      \"id\"
    ],
    \"message\": \"Invalid UUID\"
  }
]"


[36m [2m笶ｯ[22m src/features/recei
pt/__tests__/ReceiptSchema.test.ts:
[2m57:57[22m[39m
    [90m 55| [39m
[2m Test Files [22m [1m[31m7 failed[39m[22m[2m | [22m[1m[32m11 passed[39m[22m[90m (18)[39m
[2m      Tests [22m [1m[31m9 failed[39m[22m[2m | [22m[1m[32m92 passed[39m[22m[90m (101)[39m
[2m   Start at [22m 08:19:55
[2m   Duration [22m 578ms[2m (transform 1.54s, setup 0ms, import 2.58s, tests 130ms, environment 7ms)[22m

    [90m 56| [39m  [34mit[39m([
32m"譛牙柑縺ｪReceipt繧貞女縺大・繧後ｋ"[39m[33m
,[39m () [33m=>[39m {
    [90m 57| [39m    [34mexpect[
39m(() [33m=>[39m [33mReceiptSche
ma[39m[33m.[39m[34mparse[39m(va
lidReceipt))[33m.[39mnot[33m.[39
m[34mtoThrow[39m()[33m;[39m
    [90m   | [39m                 
                                    
   [31m^[39m
    [90m 58| [39m  })[33m;[39m
    [90m 59| [39m

[31m[2m竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡
ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ竡ｯ[11/11]竡ｯ[22m[39m

